name: Documentation

on:
  push:
    branches: [ main ]
    paths:
      - 'Documentation/**'
      - '.github/workflows/docs.yml'
  repository_dispatch:
    types: [ documentation ]

permissions:
  contents: read

jobs:
  trigger-docs-build:
    name: Trigger docs.typo3.org rebuild
    runs-on: ubuntu-latest
    steps:
      - name: Harden Runner
        uses: step-security/harden-runner@5ef0c079ce82195b2a36a210272d6b661572d83e # v2.14.2
        with:
          egress-policy: audit

      - name: Notify docs.typo3.org
        run: |
          curl -X POST \
            -H "Content-Type: application/json" \
            -d '{"branch": "main"}' \
            "https://docs.typo3.org/service/webhooks/github/${{ github.repository }}"
